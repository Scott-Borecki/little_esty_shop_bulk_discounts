<%= render partial: 'shared/admin_dashboard_nav' %>

<div class='row'>
  <div class='col-sm-12'>
    <p class='col-head'>
      Invoice #<%= @invoice.id %>
    </p>
  </div>
</div>

<div class='row'>
  <div class='col-2'>
    <h4>Customer:</h4>
  </div>

  <div class='col'>
    <p>
      <%= @invoice.customer.first_name %> <%= @invoice.customer.last_name %><br>
      <%= @invoice.customer.address %><br>
      <%= @invoice.customer.city %>, <%= @invoice.customer.state %> <%= @invoice.customer.zip %><br>
    </p>
  </div>
</div>

<p>
  <div class='row'>
    <div class='col-2'>
      <strong>Created on: </strong>
    </div>

    <div class='col'>
      <%= @invoice.formatted_time %><br>
    </div>
  </div>

  <div class='row'>
    <div class='col-2'>
      <strong>Total Revenue: </strong>
    </div>

    <div class='col'>
      <%= number_to_currency(@invoice.total_revenue) %>
    </div>
  </div>

  <div class='row'>
    <div class='col-2'>
      <strong>Total Discounted Revenue: </strong>
    </div>

    <div class='col'>
      <%= number_to_currency(@invoice.total_discounted_revenue) %>
    </div>
  </div>
</p>

<div id='invoice-status'>
  <div id='status-update-<%= @invoice.id %>' class='row'>
    <div class="col-2">
      <p>
        <strong>Status: </strong>
      </p>
    </div>

    <div class='col'>
      <%= form_with model: @invoice, url: admin_invoice_path(@invoice), method: :patch do |f| %>
        <%= f.select :status, Invoice.statuses.keys, selected: "#{@invoice.status}" %>
        <%= f.submit 'Update Invoice' %>
      <% end %>
    </div>
  </div>
</div>

<div id='invoice-items'>
  <p class='col-head'>Items on this Invoice</p>

  <table class='table'>
    <tr>
      <th>Item Name</th>
      <th>Quantity</th>
      <th>Unit Price</th>
      <th>Status</th>
    </tr>

    <% @invoice.invoice_items.each do |invoice_item| %>
      <tr>
        <td><%= invoice_item.item.name %></td>
        <td><%= invoice_item.quantity %></td>
        <td><%= number_to_currency(invoice_item.unit_price) %></td>
        <td><%= invoice_item.status%></td>
      </tr>
    <% end %>
  </table>
</div>
