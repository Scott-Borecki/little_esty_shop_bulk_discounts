<%= render partial: 'shared/merchant_dashboard_nav', locals: { merchant: @merchant } %>

<div class='row'>
  <% # FULL COLUMN %>
  <div class='col-sm-12'>
    <p class='col-head' id='invoice-id'>
      Invoice #<%= @invoice.id %>
    </p>
  </div>
</div>

<div class='row'>
  <% # FULL COLUMN %>
  <div class='col-sm-12'>
    <p id='invoice-details'>
      <strong>Customer: </strong>
        <%= @customer.first_name %> <%= @customer.last_name %><br>
      <strong>Created on: </strong>
        <%= @invoice.formatted_time %><br>
      <strong>Total Revenue: </strong>
        <%= number_to_currency(@invoice.total_revenue) %><br>
      <strong>Total Discounted Revenue: </strong>
        <%= number_to_currency(@invoice.total_discounted_revenue) %>
      <div id='invoice-status'>
        <strong>Status: </strong>
          <%= @invoice.status.humanize %>
      </div>
    </p>

    <p class='col-head'>Items on this Invoice</p>

    <table class='table'>
        <tr>
          <th>Item Name</th>
          <th>Quantity</th>
          <th>Unit Price</th>
          <th>Status</th>
        </tr>

        <% @invoice.invoice_items.each do |invoice_item| %>
          <tr id='ii-<%= invoice_item.id %>'>
            <td><%= invoice_item.item.name %></td>
            <td><%= invoice_item.quantity %></td>
            <td><%= number_to_currency(invoice_item.unit_price) %></td>
            <td>
              <%= form_with model: @invoice,
                            url: merchant_invoice_path(@merchant, @invoice),
                            method: :patch,
                            local: true do |f| %>
                <%= f.select :status, Invoice.statuses.keys, selected: "#{@invoice.status}" %>
                <%= f.submit 'Update Invoice' %>
              <% end %>
            </td>
          </tr>
        <% end %>
    </table>
  </div>
</div>
